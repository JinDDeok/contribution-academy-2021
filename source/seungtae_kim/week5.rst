:orphan:

OpenStack 팀 5번째 스프린트 진행사항 : 각자 스토리보드에서 오픈스택 버그 이슈를 발견하고, 버그 해결하기
================================================================================================================


1. 먼저 버그를 찾아보자
------------------------------------------------

- 5주차 팀 업무는 이제 멘토님이 각 멘티들에게 해야할 일을 분담해주는 게 아니라 스스로 스토리보드에서 해결해 볼 수 있을 것으로 보이는 버그들을 찾아내고, 그 버그들을 이번 주 팀 회의 날에 가져와 해결할만한 일인지, 이미 해결한 일인지를 판단하는 작업이었다.

- 이에 따라 우리가 주로 다루는 내용은 python-openstackclient, openstack sdk, osc_lib 3개의 이슈에 관한 것이었고, 나도 나름대로 열심히 올라온 버그들을 찾아봤던 것 같다.

- 그런데 이미 해결된 이슈가 merged로 종료되지 않은 것들이 꽤 있었고, 그것들을 분류하면서 내가 해결할만한 작업을 찾는 것은 쉽지 않았다.

- 그럼에도 해결해 볼 수 있는 이슈들이 있었고, 나는 5주차 내가 할 업무로 다음과 같은 일들을 후보로 추렸다.

    - SDK : `KeyError: 'owner' when trying to get server details using id <https://storyboard.openstack.org/#!/story/2008678>`_

    - CLI : `--mask doesn't take effect <https://storyboard.openstack.org/#!/story/2008816>`_

    - OSC-LIB : `python-openstackclient loops through all the images when a image is not available <https://storyboard.openstack.org/#!/story/2006561>`_

- 다만, 현재 해결해 볼 수 있는 가장 유력한 후보로 CLI의 --mask가 작동되지 않는다는 버그를 선택하게 되었고, 곧 이 버그가 단순히 눈에 보이는 코드 에러 이상의 많은 것들을 고쳐야한다는 것을 알게 된다.

2. 버그를 분석하자
------------------------------------------------

- 지난 주와 이번 주에 거쳐서 코딩 테스트가 있다보니 많은 시간을 할애하지는 못했지만, 기본적으로 에러의 요지는 다음과 같다.

.. image:: https://user-images.githubusercontent.com/40455392/133932000-9786ebc3-49cf-448c-80c4-dc0c145d0a9a.png
   :width: 1000px

- 오픈 스택의 명령어 중에 openstack configuration show --mask 가 있고, 이 명령어를 사용하면 패스워드를 가려서 설정을 보여주게끔 하는 것인데, 해당 값이 패스워드가 그대로 노출되는 상황이다.

.. code-block:: console

    > openstack configuration show --mask


.. image:: https://user-images.githubusercontent.com/40455392/133932093-596ffbcc-6b30-4470-b062-b23d8dec21a4.png
   :width: 1000px

- 생각보다 쉽게 고칠 수 있을 것 같아서 내가 선택한 것이었고, 나는 처음에 코드를 다음과 같이 고쳤다.

3. 버그의 원인을 해결해보자
------------------------------------------------

.. code-block:: python

    for secret_opt in secret_opts:
        if secret_opt in info and parsed_args.mask:
            info[secret_opt] = REDACTED

- 코드는 기본적으로 위와 같이 작성했고, 비밀번호는 아래와 같이 가려진다.

.. code-block:: console

    | password  | <redacted> |

- 그러나 tox를 사용해서 오픈스택의 테스트 케이스를 돌려보면, 문제가 발생한다.

.. image:: https://user-images.githubusercontent.com/40455392/133932206-e7b3d288-1b6a-4c62-8407-70ac7db1a1d1.png
   :width: 1000px

- 테스트 케이스에서 테스트하는 양식과 configuration.py의 take_action 함수의 info 변수와 내용이 다른 상황이었다.

- 즉, 테스트 케이스를 수정해서 커밋해야하는 보다 더 어려운 상황이었던 것.

4. 5주차 결과
------------------------------------------------

- 5주차 스프린트 데이 내내 해당 문제를 갖고 어느 부분에서 값이 잘못 전달되는지 찾고자 했으나, 내가 찾지는 못했다.

- 멘토님이 발견하셨는데, 발견하는 과정을 잘 살펴보면 파이참의 디버깅 모드를 정말 잘 활용하는 것을 볼 수 있었다.

- 나는 약간 멘땅에 해당하는 느낌으로 코드 파일을 일일이 다 찾아다녔는데, 작업 생산성을 높이려면 디버깅을 잘 활용하는 것이 매우 중요한 것으로 보인다.

- 결국 아직 코드 수정은 못했는데 최대한 추석 내에 해결하고, 다음 주 목요일 미팅 때 한 번 결과 보고를 해보는 방식으로 접근해야겠다.

5. 후기
------------------------------------------------

- 상황에 따라 테스트 케이스를 수정하고 커밋하는 것도 컨트리뷰션이라고 한다.

- 이번 주 성과가 없어서 매우 낙담했는데, 멘토님이 잘 격려해주신 덕분에 성과가 없더라도 오늘 코드를 찾아갔던 과정을 잘 기록하면 그것 자체가 성장에 큰 기여를 할 것이라고 했다.

- 유독 느낀 부분들이 많지만, 파이참이 제공하는 IDE의 디버깅 모드를 활용하는 방법이 조금 더 다양하게 있다.

- Tox 테스트 케이스 돌리는 것도 디버깅 모드에서 조절하던데 스프린트 때 워낙 코드 찾는 것에 집중하다보니 제대로 못 본 게 조금 아쉽다.

- 5주차에 에러를 잡고 갔으면 조금 여유가 있었을텐데 아쉽다.

- 스토리보드에서 glance의 pyhton-openstackclient, sdk, osc_lib 3개 레포에 관한 버그를 찾아서 해결하는 것을 신규 과제로 주어졌다.

- 먼저 지금 해결 중인 에러를 잡고, glance에서 발생하는 에러들도 해결해 나가보자.